/*! ZipZap 2015-08-09 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("./config"),e=a("./modal"),f=a("./setup"),g=null,h=null,i=null,j=null,k=null,l=null,m={},n={},o=n,p={},q=p;m.init=function(a){h=d.get("difficulty"),i=document.querySelector("."+d.getStatic("matrixWrapperClass")),j=document.querySelector("."+d.getStatic("app").headerClass),k=document.querySelector("."+d.getStatic("app").wrapperClass),l=Math.floor((new Date).getTime()*Math.random()*2).toString(),i&&o.prepareMatrix()},n.prepareMatrix=function(){g=new Array(h);for(var a=0;h>a;a+=1)g[a]=[];o.startGame()},n.startGame=function(){o.resetDifficultyBanner(),o.movements("reset"),o.makeMatrix(),o.draw()},n.makeMatrix=function(){var a,b,c,d,e,f=[],i=h*h;for(d=0;i>d;d+=1)a=Math.floor(d/h),b=d%h,c={row:a,col:b,observer:n},e=Math.ceil(Math.random()*i)-1,-1===f.indexOf(e)?(f.push(e),c.value=e,0===e&&(c.pointer=!0),g[a][b]=q.Box(c)):d-=1},n.draw=function(){var a=document.createDocumentFragment();o.each(function(b){var c=document.createElement("div");c.classList.add(d.getStatic("boxWrapperClass")),c.appendChild(b.e),a.appendChild(c)}),i.innerHTML="",i.appendChild(a),k.classList.remove(d.getStatic("invisibleClass"))},n.each=function(a){for(var b=0;h>b;b+=1)for(var c=0;h>c;c+=1)a(g[b][c])},n.notify=function(a){o.each(function(b){b.inRangeOf(a)&&o.changePosition(b,a)})},n.changePosition=function(a,b){if(o.areNeighbors(a,b)){var c=Object.create(g[a.row][a.col]);g[a.row][a.col]=b,g[b.row][b.col]=c,c.row=b.row,c.col=b.col,b.row=a.row,b.col=a.col,o.movements("add"),o.draw(),o.checkState()}},n.checkState=function(){var a,b,c,d,e=0;for(a=0;h>a;a++)for(b=0;h>b;b++){if(c=g[a][b],d=c.value?c.value:h*h,!(d>e))return;e=d}o.endGame()},n.endGame=function(){e.changeToTemplate("confirm",{title:"Parabéns!",content:"Você terminou o jogo com <strong>"+d.get("movements",l)+" movimentos</strong> no <strong>nível "+(h-2)+"</strong>.",btnConfirmMessage:"Jogar novamente",confirmCallback:o.startGame,btnDeclineMessage:"Mudar dificuldade",btnDeclineColor:"green",declineCallback:o.changeDifficulty}).show()},n.changeDifficulty=function(){f.changeDifficulty()},n.areNeighbors=function(a,b){return o.checkNeighborhood(a,b)||o.checkNeighborhood(b,a)},n.checkNeighborhood=function(a,b){var c=a.col==b.col-1||a.col==b.col+1,d=a.row==b.row,e=a.row==b.row-1||a.row==b.row+1,f=a.col==b.col;return c&&d||e&&f},n.movements=function(a,b){var c=document.querySelector("."+d.getStatic("counterClass")),e=d.get("movements",l);switch(a){case"add":e=b?e+b:e+1,c.innerText=e,d.set("movements",e,!0,l);break;case"reset":d.set("movements",0,!0,l),c.innerText=0}},n.resetDifficultyBanner=function(){var a=d.getStatic("app").difficultyNumberClass,b=document.querySelector("."+a);b.innerText=h-2},n.getPointer=function(){var a=null;return o.each(function(b){b.pointer&&(a=b)}),a},p.Box=function r(a){return this instanceof r?(this.e=document.createElement("div"),this.row=a.row,this.col=a.col,this.observer=a.observer,this.target=null,this.pointer=a.pointer||!1,this.value=isNaN(a.value)?null:a.value,void this.init()):new p.Box(a)},p.Box.prototype={dif:null,touchStart:null,touchMove:null,touchEnd:null,init:function(){this.setupStyle(),this.setupContent(),this.touchMove=this.onTouchMove.bind(this),this.touchEnd=this.onTouchEnd.bind(this),this.touchStart=this.onTouchStart.bind(this),!this.pointer&&this.addStartEvent()},setupStyle:function(){var a=this.e.classList;a.add(d.getStatic("boxClass")),this.pointer&&a.add(d.getStatic("boxPointerClass"))},setupContent:function(){this.e.innerHTML=this.value},getPosition:function(){return{x:parseFloat(this.e.offsetLeft),y:parseFloat(this.e.offsetTop)}},getBounds:function(){return{width:this.e.offsetWidth,height:this.e.offsetHeight}},addStartEvent:function(){this.e.addEventListener(d.EventType.touchstart,this.touchStart)},addMovingEvents:function(){document.addEventListener(d.EventType.touchmove,this.touchMove),document.addEventListener(d.EventType.touchend,this.touchEnd)},removeEvents:function(){document.removeEventListener(d.EventType.touchmove,this.touchMove),document.removeEventListener(d.EventType.touchend,this.touchEnd)},canMove:function(){return this.observer.areNeighbors(this,this.observer.getPointer())},onTouchStart:function(a){if(this.canMove()){var b=d.get("touchStyle");"click"===b?this.moveOnClick(a):this.moveOnDrag(a)}},moveOnClick:function(a){return this.observer.changePosition(this.observer.getPointer(),this)},moveOnDrag:function(a){var b=d.translateEventPosition(a),c=this.getPosition();a.preventDefault(),this.dif={x:b.x-c.x,y:b.y-c.y},this.e.classList.add(d.getStatic("boxMovingClass")),this.addMovingEvents()},onTouchMove:function(a){var b=d.translateEventPosition(a),c=this.e.style;a.preventDefault(),c.top=b.y-this.dif.y+"px",c.left=b.x-this.dif.x+"px"},onTouchEnd:function(a){var b=d.translateEventPosition(a),c=this.e.style;a.preventDefault(),this.target={x:parseInt(b.x),y:parseInt(b.y)},this.e.classList.remove(d.getStatic("boxMovingClass")),c.top="",c.left="",this.removeEvents(),this.observer.notify(this)},inRangeOf:function(a){return this.inMyRange(a)&&this.pointer},inMyRange:function(a){var b=a.target,c=this.getPosition(),d=this.getBounds(),e=c.x<=b.x&&b.x<=c.x+d.width,f=c.y<=b.y&&b.y<=c.y+d.height;return e&&f}},b.exports=m},{"./config":2,"./modal":5,"./setup":6}],2:[function(a,b,c){var d={},e=d,f={},g=f;f.statics={appName:"ZipZap",difficult:3,hideClass:"hide",invisibleClass:"invisible",app:{wrapperClass:"app-wrapper",headerClass:"app-header",gameContainerClass:"game-container",difficultyChangeClass:"app-difficulty",difficultyNumberClass:"app-difficulty-num",menuClass:"app-menu"},modal:{mainClass:"app-modal",closeButtonClass:"app-modal-close-btn",containerClass:"app-modal-container",titleFieldClass:"app-modal-title",contentFieldClass:"app-modal-content",footerClass:"app-modal-footer",defaultBtnClass:"app-modal-default-btn",hideClass:"hidden"},boxClass:"app-box",boxPointerClass:"app-box-pointer",boxWrapperClass:"app-box-wrapper",boxMovingClass:"app-box-moving",matrixWrapperClass:"matrix-wrap",counterClass:"movements",touchStyles:[{name:"click",fullName:"Clicar"},{name:"drag",fullName:"Arrastar"}]},f.data={touchStyle:"drag"},d.init=function(){e.set("difficulty",3)},d.isMobile=function(a){var b=/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/;return b.test(a)}(window.navigator.userAgent),d.EventType=function(){var a=e.isMobile;return{touchstart:a?"touchstart":"mousedown",touchmove:a?"touchmove":"mousemove",touchend:a?"touchend":"mouseup"}}(),d.translateEventPosition=function(a){if(e.isMobile){var b;return b=a.touches.length?a.touches[0]:a.changedTouches.length?a.changedTouches[0]:a.targetTouches.length?a.targetTouches[0]:{clientX:0,clientY:0},{x:b.clientX,y:b.clientY}}return{x:a.pageX,y:a.pageY}},d.getStatic=function(a){return g.get(a,g.statics)},d.get=function(a,b){return g.get(a,g.data,b)},d.set=function(a,b,c,d){if(!a)return!1;var e=g.data,f=b;return"string"==typeof c&&(f={value:b,hash:c}),e.hasOwnProperty(a)&&"boolean"==typeof c&&c?e[a].hash&&e[a].hash===d?(e[a]=f,!0):e[a].hash?!1:(e[a]=f,!0):e.hasOwnProperty(a)?!1:(e[a]=f,!0)},d.getWindowBounds=function(a){var b="."+g.statics.app.headerClass,c=document.querySelector(b).offsetHeight;return{width:window.innerWidth,height:a?window.innerHeight:window.innerHeight-c}},d.resolveAppBounds=function(){var a=e.getWindowBounds();return a.width==a.height?a.width:a.width>a.height?a.height:a.width},f.get=function(a,b,c){if(!b.hasOwnProperty(a))return null;var d=b[a].hash;return d&&c?d!==c?null:b[a].value:b[a]},b.exports=d},{}],3:[function(a,b,c){var d=a("./modal"),e=a("./config"),f=a("./setup"),g=(a("./app"),a("./menu")),h={},i={},j=i;i.init=function(){j.setupEvents()},i.setupEvents=function(){window.addEventListener("load",j.onWindowLoad)},i.onWindowLoad=function(){e.init(),d.init(),f.init(),g.init()},j.init(),b.exports=h},{"./app":1,"./config":2,"./menu":4,"./modal":5,"./setup":6}],4:[function(a,b,c){var d=a("./config"),e=a("./modal"),f=null,g={},h={},i=h;g.init=function(){f=document.querySelector("."+d.getStatic("app").menuClass),h.setupEvents()},h.setupEvents=function(){f.addEventListener("click",i.handleClick)},h.handleClick=function(a){var b=a.target.hash.replace("#","");"instruction"===b&&h.openInstructions(),"configuration"===b&&h.openConfiguration(),"about"===b&&h.openAbout()},h.openInstructions=function(){i.showModal({title:"Instruções",content:"Seu objetivo será movimentar todos os <strong>tiles</strong> (quadrados) de maneira que fiquem <strong>ordenados</strong> a partir da esquerda para a direita, linha por linha. O tile <strong>curinga</strong> deve ficar no canto inferior direito."})},h.openConfiguration=function(){var a,b,c,e,f=d.getStatic("touchStyles"),g=document.createElement("p");b="<strong>Selecione o estilo de movimentação: </strong>",g.innerHTML=b,f.forEach(function(f){a=document.createElement("input"),a.type="radio",a.name="touch_style",a.id="touch_"+f.name,a.value=f.name,a.checked=f.name===d.get("touchStyle"),a.addEventListener("click",i.onRadioClick),e=document.createElement("label"),e.setAttribute("for","touch_"+f.name),b=document.createTextNode(" "+f.fullName),e.appendChild(b),c=document.createElement("p"),c.appendChild(a),c.appendChild(e),g.appendChild(c)}),i.showModal({title:"Configurações",content:g})},h.onRadioClick=function(a){var b=a.target.value,c=d.getStatic("touchStyles"),e=c.some(function(a){return a.name==b});e&&d.set("touchStyle",b,!0)},h.openAbout=function(){i.showModal({title:"ZipZap",content:"<p></p>"})},h.showModal=function(a){e.changeToTemplate("modal",a).show()},b.exports=g},{"./config":2,"./modal":5}],5:[function(a,b,c){var d=a("./config"),e={},f=e,g={},h=g,i=null,j=null,k=null,l=null,m=null,n=null,o=null,p=null,q=null,r=[],s=null,t={modal:{hasTitleField:!0,hasCloseButton:!0,closeOnOverlay:!0},alert:{hasCloseButton:!1},confirm:{hasCloseButton:!1,confirmMessage:"Sim",declineMessage:"Não"}},u=!1;e.init=function(a){if(u)throw new Error("Modal Module already initialized.");var b=d.getStatic("modal"),c=b.mainClass,e=b.closeButtonClass,f=b.containerClass,g=b.titleFieldClass,i=b.footerClass,j=b.contentFieldClass;o=b.defaultBtnClass,q=b.hideClass,p=d.getStatic("hideClass"),h.registerDOMElements({modal:c,closeButton:e,container:f,title:g,content:j,footer:i}),a&&a.template?h.changeToTemplate(a.template):h.setModal(),u=!0},e.show=function(){return i.classList.remove(q),h.addEvents(),e},e.hide=function(a){return"confirm"!=s?(h.hide(a),e):void 0},e.reset=function(){return h.clearTemplate(),e},e.isVisible=function(){return!i.classList.contains(q)},e.changeToTemplate=function(a,b){if("modal"==a)return h.setModal(b);if("alert"==a)return h.setAlert(b);if("confirm"==a)return h.setConfirm(b);if(h.getCustomTemplate(a))return h.setCustomTemplate(a,b);throw new Error("Template not found.")},e.addCustomTemplate=function(a,b){if(!a||!b)throw new Error("You forgot some params to create a custom template.")},e.setContent=function(a){if(!s)throw new Error("You have to set a template before setting the content.");return"modal"==s?h.setContentModal(a):"alert"==s?h.setContentAlert(a):"confirm"==s?h.setContentConfirm(a):h.setContentCustomTemplate(a)},g.addEvents=function(){document.addEventListener("keydown",h.hideOnEsc)},g.removeEvents=function(){document.removeEventListener("keydown",h.hideOnEsc)},g.hideOnEsc=function(a){27!==a.keyCode||h.hasCloseButton()||h.hide()},g.hasCloseButton=function(){return j.classList.contains(p)},g.registerDOMElements=function(a){if(!(a&&a.modal&&a.closeButton&&a.container&&a.content&&a.title&&a.footer))throw new Error("To register the modal you have to specify all the HTMLDOMElements.");i=document.querySelector("."+a.modal),j=document.querySelector("."+a.closeButton),k=document.querySelector("."+a.container),m=document.querySelector("."+a.content),l=document.querySelector("."+a.title),n=document.querySelector("."+a.footer)},g.hide=function(a){a&&a.preventDefault&&a.preventDefault(),i.classList.add(q),h.removeEvents()},g.clearTemplate=function(a){var b=i.classList;s=null,[].forEach.call(b,function(a,b){i.classList.remove(a)}),a&&a.hide&&f.hide(),b.add(d.getStatic("modal").mainClass),n.innerHTML="",m.innerHTML="",l.innerHTML=""},g.setModal=function(a){return h.clearTemplate({hide:!f.isVisible()}),!a||a.showCloseButton||t.modal.hasCloseButton?h.showCloseButton():h.hideCloseButton(),a&&h.setContentModal(a),s="modal",e},g.setAlert=function(a){return h.clearTemplate({hide:!f.isVisible()}),!a||a.showCloseButton||t.alert.hasCloseButton?h.showCloseButton():h.hideCloseButton(),i.classList.add("alert-template"),a&&h.setContentAlert(a),s="alert",e},g.setConfirm=function(a){return h.clearTemplate({hide:!f.isVisible()}),!a||a.showCloseButton||t.confirm.hasCloseButton?h.showCloseButton():h.hideCloseButton(),i.classList.add("confirm-template"),a&&h.setContentConfirm(a),s="confirm",e},g.setCustomTemplate=function(a,b){},g.hideCloseButton=function(){j.classList.add(p),h.removeCloseEvent()},g.showCloseButton=function(){j.classList.remove(p),h.addCloseEvent()},g.addCloseEvent=function(a){j=a||j,j.addEventListener(d.EventType.touchstart,f.hide)},g.removeCloseEvent=function(a){j=a||j,j.removeEventListener(d.EventType.touchstart,f.hide)},g.getCustomTemplate=function(a){if(!a)return null;for(var b=0,c=r.length;c>b;b++)if(r[b].name==a)return r[b];return null},g.setContentModal=function(a){return a.content&&"string"==typeof a.content?m.innerHTML=a.content:m.appendChild(a.content),a.title&&(l.innerHTML=a.title),h.configFooter({hide:!0}),e},g.setContentAlert=function(a){a.content&&(m.innerHTML=a.content),a.title&&(l.innerHTML=a.title);var b=[f.hide];return a.btnCallback&&b.push(a.btnCallback),h.configFooter({hide:!1,buttons:[{color:"blue",text:a.btnText,clicks:b}]}),e},g.setContentConfirm=function(a){function b(){h.hide(),a.confirmCallback&&a.confirmCallback()}function c(){h.hide(),a.declineCallback&&a.declineCallback()}a.title&&(l.innerHTML=a.title),a.content&&(m.innerHTML=a.content);var d=a.btnConfirmMessage?a.btnConfirmMessage:t.confirm.confirmMessage,f=a.btnDeclineMessage?a.btnDeclineMessage:t.confirm.declineMessage;return h.configFooter({hide:!1,buttons:[{color:a.btnConfirmColor||"blue",text:d,clicks:b},{color:a.btnDeclineColor||"red",text:f,clicks:c}]}),e},g.setContentCustomTemplate=function(a){},g.configFooter=function(a){if(n.innerHTML="",a.hide?n.classList.add("hide"):n.classList.remove("hide"),a.buttons)for(var b,c=a.buttons.length,e=0;c>e;e++){var f=document.createElement("button");if(f.innerText=a.buttons[e].text,f.classList.add(o),f.classList.add(a.buttons[e].color),b=a.buttons[e].clicks,"Array"===b.constructor.name&&b.length)for(var g=a.buttons[e].clicks.length-1;g>=0;g--)f.addEventListener(d.EventType.touchstart,a.buttons[e].clicks[g]);else f.addEventListener(d.EventType.touchstart,a.buttons[e].clicks);n.appendChild(f)}},b.exports=e},{"./config":2}],6:[function(a,b,c){var d=a("./config"),e=a("./modal"),f=a("./app"),g={},h=g,i={},j=i,k=!0,l=null,m=null;h.done=!1,g.init=function(){j.prepare(),k?j.initUserSetup():j.configDifficulty()},g.changeDifficulty=function(){l=d.get("difficulty"),j.configDifficulty({title:"Modificar dificuldade",showCloseButton:!0})},i.prepare=function(){var a;try{a=localStorage.getItem("tutorial")}catch(b){console.log("error on localstorage",b)}a&&(k=!1),m=d.resolveAppBounds()/40-2},i.setupEvents=function(){var a="."+d.getStatic("app").difficultyChangeClass,b=document.querySelector(a);b.addEventListener(d.EventType.touchstart,h.changeDifficulty)},i.configBoundsAndStyles=function(){var a=d.get("difficulty"),b=d.resolveAppBounds(),c="."+d.getStatic("app").wrapperClass,e="."+d.getStatic("boxWrapperClass"),f="."+d.getStatic("boxClass"),g="."+d.getStatic("boxPointerClass"),h=b/a,i=h/2.5>32?32:h/2.5,j=document.querySelector("style")||document.createElement("style"),k=2,l="";l+=c+"{width: "+b+"px;}",l+=e+"{width: "+h+"px;height: "+h+"px;padding: 1px}",l+=f+", "+g+"{width: "+(h-k)+"px;height: "+(h-k)+"px;font-size: "+i+"px;line-height: "+(h-k)+"px;}",j.appendChild(document.createTextNode(l)),document.head.appendChild(j)},i.initUserSetup=function(){e.changeToTemplate("confirm",{title:"Bem vindo ao ZipZap!",content:"<strong>ZipZap</strong> é um simples jogo de ordenação de números.<br><br>Quer saber mais sobre o jogo e até <strong>configurá-lo</strong>?",btnConfirmMessage:"Sim",btnDeclineMessage:"Não",confirmCallback:j.showTutorial,declineCallback:j.finishSetup}).show()},i.showTutorial=function(){e.setContent({title:"Bem vindo ao ZipZap!",content:"Seu objetivo será movimentar todos os <strong>tiles</strong> (quadrados) de maneira que fiquem <strong>ordenados</strong> a partir da esquerda para a direita, linha por linha. O tile <strong>curinga</strong> deve ficar no canto inferior direito.<br><br>Você ainda pode escolher o <strong>nível de dificuldade</strong> que deseja jogar. Por padrão, o jogo começa no primeiro nível de dificuldade, com um 9 tiles. Deseja modificar a dificuldade?",btnConfirmMessage:"Sim",btnDeclineMessage:"Não, quero jogar!",confirmCallback:j.configDifficulty,declineCallback:j.finishSetup}).show()},i.configDifficulty=function(a){for(var b="",c=2;m>c;c++)b+='<option value="'+c+'"'+(c===l-2?'selected="selected"':"")+">Nível "+c+"</option>";e.changeToTemplate("alert",{title:a&&a.title?a.title:"Dificuldade",showCloseButton:a&&a.showCloseButton?a.showCloseButton:!1,content:'Por favor, selecione o nível de dificuldade que deseja jogar: <br><br><select class="app-difficulty-select"><option value="1" selected>Nível 1</option>'+b+"</select>",btnText:"Jogar!",btnCallback:j.setDifficulty}).show()},i.setDifficulty=function(){var a=document.querySelector(".app-difficulty-select"),b=Number(a.value)+2;d.set("difficulty",b,!0);try{localStorage.setItem("tutorial",!0)}catch(c){console.log("error on localstorage",c)}j.finishSetup()},i.finishSetup=function(){e.reset().hide(),l&&l===d.get("difficulty")||j.configBoundsAndStyles(),f.init(),j.setupEvents()},b.exports=g},{"./app":1,"./config":2,"./modal":5}]},{},[3]);